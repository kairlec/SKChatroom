<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.skstudio.dao.MailSenderMapper">

    <update id="initializeTable">
        CREATE TABLE IF NOT EXISTS mail_sender_config(id INT1 NOT NULL PRIMARY KEY,port INT NOT NULL,host VARCHAR(256) NOT NULL,protocol VARCHAR(32) NOT NULL,encoding VARCHAR(16) NOT NULL,username VARCHAR(64) NOT NULL,password VARCHAR(64) NOT NULL);
    </update>

    <select id="getMailSender" resultType="cn.skstudio.pojo.MailSender">
        SELECT *
        FROM mail_sender_config
        WHERE id = 1
    </select>

    <insert id="initializeSender" parameterType="cn.skstudio.pojo.MailSender">
        INSERT INTO mail_sender_config(id,port,host,protocol,encoding,username,password) SELECT 1,#{port},#{host},#{protocol},#{encoding},#{username},#{password} FROM DUAL WHERE NOT EXISTS(SELECT id FROM mail_sender_config WHERE id = 1);
    </insert>

    <update id="updateMailSender" parameterType="cn.skstudio.pojo.MailSender">
        UPDATE
        `mail_sender_config`
        <set>
            port = #{port},
            host = #{host},
            protocol = #{protocol},
            encoding = #{encoding},
            username = #{username},
            password = #{password}
        </set>
        WHERE id = 1
    </update>

</mapper>